# dns_cache
Был реализован минимальный функционал днс сервера.
## Реализовано
- Работа по UDP
- Парсинг пакета
- Самостоятельная сборка пакета
- Opcode = 0
- Обработка ошибок:
  - возникающих при обращении к forwarder серверу;
  - из-за получении некорректных пакетов;
  - возникающих во время работы
- Записи A, NS, MX
  - остальные записи тоже обрабатываются, но  те, в которых есть днс имена могут некорректно работать, если имена являются ссылками внутри пакета
## Нереализовано
- Работа по tcp
- Opcode = 1 | 2
- Рекурсивные запросы
  - из-за этого в некоторых случаях можно не получить SOA записи, возможно ещё какие-нибудь
- Обработка зацикливания (корректное поведение сервера в случае, если в качестве «старшего сервера» указан он же сам, или экземпляр его, запущенный на другой машине). Это ошибка при настройке, поэтому не стал пытаться обрабатывать.
## Запуск
### Командная строка
python dns_cache флаги
#### -h, --help
для вызова справки
#### --port N 
N - порт, на котором будет работать сервер, по умоланию 53
#### -p N
то же, что и --port N
#### --forwarder host[:port]
указание forwarder сервера, к которому следует обращатся,
если порт не указан, то по умолчанию 53. По умолчанию 
8.8.8.8:53.
#### -f host[:port]
то же, что и --forwarder host[:port]
#### exit 
чтобы остановть работу сервера
#### Примеры:
- python dns_cache
- python dns_cache -p 100
- python dns_cache -f 1.1.1.1:77
- python dns_cache -f 1.1.1.1 -p 88
### DNSCacheServer(forwarder).start(host, port)
Например: DNSCacheServer(forwarder=('192.168.31.1', 53)).start(host='192.168.31.172', port=100)

Можно запусить dns_cache\dns_cache_server.py
## Тестирование
Тесты в tests.pdf.
- Для тестирования запускал на 100 порту, тк на 53 уже что-то работало.
- На роутере включал переадресацию с его 53 порта на мой 100.
- Пробовал nslookup в командной строке, но не получилось его настроить, чтобы протестировать, поэтому использовал сервис [dig](https://2whois.ru/?t=dig), где указывал ip моего роутера.
